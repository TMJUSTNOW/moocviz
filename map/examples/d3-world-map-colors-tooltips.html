<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252"><title>http://techslides.com/demos/d3/d3-world-map-colors-tooltips.html</title><link rel="stylesheet" type="text/css" href="d3-world-map-colors-tooltips_files/viewsource.css"></head><body id="viewsource" style="-moz-tab-size: 4"><pre id="line1"><span></span><span class="doctype">&lt;!DOCTYPE html&gt;</span><span>
<span id="line2"></span></span><span>&lt;<span class="start-tag">meta</span> <span class="attribute-name">charset</span>="<a class="attribute-value">utf-8</a>"&gt;</span><span>
<span id="line3"></span></span><span>&lt;<span class="start-tag">title</span>&gt;</span><span>D3 World Map Demo with Country Tooltips and Colors | TechSlides</span><span>&lt;/<span class="end-tag">title</span>&gt;</span><span>
<span id="line4"></span></span><span>&lt;<span class="start-tag">style</span>&gt;</span><span>
<span id="line5"></span>body { 
<span id="line6"></span>  color: #666; 
<span id="line7"></span>  background: #f3f3f3; 
<span id="line8"></span>  font: normal 10px "Helvetica Neue", Helvetica, sans-serif; 
<span id="line9"></span>  margin: 2em; 
<span id="line10"></span>}
<span id="line11"></span>#map {
<span id="line12"></span>  border:2px solid #000;
<span id="line13"></span>  width:960px;
<span id="line14"></span>  height:550px;
<span id="line15"></span>}
<span id="line16"></span>.country {
<span id="line17"></span>  fill: #ccc;
<span id="line18"></span>  stroke: #fff;
<span id="line19"></span>  stroke-width: .5px;
<span id="line20"></span>  stroke-linejoin: round;
<span id="line21"></span>}
<span id="line22"></span>
<span id="line23"></span>.hidden { 
<span id="line24"></span>  display: none; 
<span id="line25"></span>}
<span id="line26"></span>div.tooltip {
<span id="line27"></span>  color: #222; 
<span id="line28"></span>  background: #fff; 
<span id="line29"></span>  padding: .5em; 
<span id="line30"></span>  text-shadow: #f5f5f5 0 1px 0;
<span id="line31"></span>  border-radius: 2px; 
<span id="line32"></span>  box-shadow: 0px 0px 2px 0px #a6a6a6; 
<span id="line33"></span>  opacity: 0.9; 
<span id="line34"></span>  position: absolute;
<span id="line35"></span>}
<span id="line36"></span>
<span id="line37"></span></span><span>&lt;/<span class="end-tag">style</span>&gt;</span><span>
<span id="line38"></span></span><span>&lt;<span class="start-tag">body</span>&gt;</span><span>
<span id="line39"></span></span><span>&lt;<span class="start-tag">h1</span>&gt;</span><span>D3 World Map Demo with Country Tooltips, Colors, TopoJSON and Queue</span><span>&lt;/<span class="end-tag">h1</span>&gt;</span><span>
<span id="line40"></span></span><span>&lt;<span class="start-tag">a</span> <span class="attribute-name">href</span>="<a href="view-source:http://techslides.com/d3-world-maps-tooltips-zooming-and-queue/" class="attribute-value">http://techslides.com/d3-world-maps-tooltips-zooming-and-queue/</a>"&gt;</span><span>Back to Article</span><span>&lt;/<span class="end-tag">a</span>&gt;</span><span>
<span id="line41"></span></span><span>&lt;<span class="start-tag">br</span>&gt;</span><span></span><span>&lt;<span class="start-tag">br</span>&gt;</span><span>
<span id="line42"></span></span><span>&lt;<span class="start-tag">div</span> <span class="attribute-name">id</span>="<a class="attribute-value">map</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">div</span>&gt;</span><span>
<span id="line43"></span>
<span id="line44"></span></span><span>&lt;<span class="start-tag">script</span> <span class="attribute-name">src</span>="<a href="view-source:http://techslides.com/demos/d3/js/d3.v3.min.js" class="attribute-value">js/d3.v3.min.js</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">script</span>&gt;</span><span>
<span id="line45"></span></span><span>&lt;<span class="start-tag">script</span> <span class="attribute-name">src</span>="<a href="view-source:http://techslides.com/demos/d3/js/queue.v1.min.js" class="attribute-value">js/queue.v1.min.js</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">script</span>&gt;</span><span>
<span id="line46"></span></span><span>&lt;<span class="start-tag">script</span> <span class="attribute-name">src</span>="<a href="view-source:http://techslides.com/demos/d3/js/topojson.js" class="attribute-value">js/topojson.js</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">script</span>&gt;</span><span>
<span id="line47"></span></span><span>&lt;<span class="start-tag">script</span>&gt;</span><span>
<span id="line48"></span>// The SVG container
<span id="line49"></span>var width  = 960,
<span id="line50"></span>    height = 550;
<span id="line51"></span>
<span id="line52"></span>var color = d3.scale.category10();
<span id="line53"></span>
<span id="line54"></span>var projection = d3.geo.mercator()
<span id="line55"></span>                .translate([480, 300])
<span id="line56"></span>                .scale(970);
<span id="line57"></span>
<span id="line58"></span>var path = d3.geo.path()
<span id="line59"></span>    .projection(projection);
<span id="line60"></span>
<span id="line61"></span>var svg = d3.select("#map").append("svg")
<span id="line62"></span>    .attr("width", width)
<span id="line63"></span>    .attr("height", height);
<span id="line64"></span>
<span id="line65"></span>var tooltip = d3.select("#map").append("div")
<span id="line66"></span>    .attr("class", "tooltip");
<span id="line67"></span>
<span id="line68"></span>queue()
<span id="line69"></span>    .defer(d3.json, "data/world-110m.json")
<span id="line70"></span>    .defer(d3.tsv, "data/world-country-names.tsv")
<span id="line71"></span>    .await(ready);
<span id="line72"></span>
<span id="line73"></span>function ready(error, world, names) {
<span id="line74"></span>
<span id="line75"></span>  var countries = topojson.object(world, world.objects.countries).geometries,
<span id="line76"></span>      neighbors = topojson.neighbors(world, countries),
<span id="line77"></span>      i = -1,
<span id="line78"></span>      n = countries.length;
<span id="line79"></span>
<span id="line80"></span>  countries.forEach(function(d) { 
<span id="line81"></span>    d.name = names.filter(function(n) { return d.id == n.id; })[0].name; 
<span id="line82"></span>  });
<span id="line83"></span>
<span id="line84"></span>var country = svg.selectAll(".country").data(countries);
<span id="line85"></span>
<span id="line86"></span>  country
<span id="line87"></span>   .enter()
<span id="line88"></span>    .insert("path")
<span id="line89"></span>    .attr("class", "country")    
<span id="line90"></span>      .attr("title", function(d,i) { return d.name; })
<span id="line91"></span>      .attr("d", path)
<span id="line92"></span>      .style("fill", function(d, i) { return color(d.color = d3.max(neighbors[i], function(n) { return countries[n].color; }) + 1 | 0); });
<span id="line93"></span>
<span id="line94"></span>    //Show/hide tooltip
<span id="line95"></span>    country
<span id="line96"></span>      .on("mousemove", function(d,i) {
<span id="line97"></span>        var mouse = d3.mouse(svg.node()).map( function(d) { return parseInt(d); } );
<span id="line98"></span>
<span id="line99"></span>        tooltip
<span id="line100"></span>          .classed("hidden", false)
<span id="line101"></span>          .attr("style", "left:"+(mouse[0]+25)+"px;top:"+mouse[1]+"px")
<span id="line102"></span>          .html(d.name)
<span id="line103"></span>      })
<span id="line104"></span>      .on("mouseout",  function(d,i) {
<span id="line105"></span>        tooltip.classed("hidden", true)
<span id="line106"></span>      });
<span id="line107"></span>
<span id="line108"></span>}
<span id="line109"></span></span><span>&lt;/<span class="end-tag">script</span>&gt;</span><span></span></pre></body></html>